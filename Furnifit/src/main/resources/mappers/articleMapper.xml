<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
                        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
                        
<mapper namespace="com.furnifit.article.dao.ArticleDao">

	
	<insert id="create" parameterType="Article">

	 <selectKey keyProperty="articleId" resultType="int" order="BEFORE">
             select articles_seq.nextval
             FROM DUAL
      </selectKey>
	
	
	 INSERT INTO articles
	 			 (article_id ,
	 			  email,
	 			  planitem_id, 
	 			  title,
	 			  content	 
	 			 )
	 VALUES      (
	 			  #{articleId},
	 			  #{email},
	 			  #{planitemId},
	 			  #{title},
	 			  #{content})
	 			  
	</insert>
	
	<!-- 게시판 상세읽기 -->
	<select id="read" parameterType="int" resultType="Article">
		 SELECT article_id AS "articleId" ,
	 		email,
	 		planitem_id AS "planitemId",
	 		likecnt,
	 		viewcnt,
	 		To_char(regdate, 'YYYY-MM-DD') regdate,
	 		title,
	 		content	
	 FROM   articles
	 WHERE  article_id = #{value}
		
	</select>
	
	<!-- 게시판 이미지 업로드 -->
	<insert id="addAttach" parameterType="map" >
	INSERT INTO article_img
				(name,
				 article_id,
				 path,
				 regdate)
	VALUES      (#{name},
				 #{articleId},
				 #{path},
				 sysdate)
	</insert>
	
	<!-- 게시판 전체리스트 -->
	   <!-- 전체 리스트 -->
   <select id="listAll" resultType="Article">
	 SELECT article_id AS "articleId",
	 		email,
	 		planitem_id AS "planitemId",
	 		likecnt,
	 		viewcnt,
	 		To_char(regdate, 'YYYY-MM-DD') regdate,
	 		title,
	 		content
	 FROM   articles
 
   </select>
   
   
	<!-- 상세게시글에 해당하는 배치도항목 정보 가져오기 -->
   <select id="readPlanItem" parameterType="int" resultType="PlanItem">
   SELECT planitem_id AS "planitemId",
   		  plan_id AS "planId",
   		  width,
   		  height,
   		  length,
   		  acreage,
   		  image,
   		  name
    FROM  planitems
    WHERE planitem_id = #{value}
   </select>
   
   <!-- 배치도항목에 해당하는 가구번호목록(리스트) 가져오기 -->
    <select id="readFurniture" parameterType="int" resultType="Furniture">
   SELECT planitem_id AS "planitemId",
   		  product_id AS "productId"
    FROM  furnitures
    WHERE planitem_id = #{value}
   </select>
   
   
   <!-- 가구번호에 대한 가구(상품)정보 가져오기 -->
   <select id="readProduct" parameterType="int" resultType="Product">
   SELECT product_id AS "productId",
   		  category,
   		  name,
   		  brand,
   		  price,
   		  color,
   		  width,
   		  length,
   		  height,
   		  description,
   		  To_char(regdate, 'YYYY-MM-DD') regdate	  
    FROM  products
    WHERE product_id = #{value}
   </select>

	
	
	
	
</mapper>